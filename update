#!/bin/bash

PLUGIN_NAME="omarchy-workspace-mover"
PLUGIN_DIR="$HOME/.config/omarchy/plugins/$PLUGIN_NAME"

if [ ! -d $PLUGIN_DIR ]; then
  echo "Error: Plugin '$PLUGIN_NAME' not found."
  exit 1
fi

cd $PLUGIN_DIR

# Remove old installation completely
if ! ./remove; then
  echo "Error: Failed to remove old installation."
  exit 1
fi

# Fresh install with latest code
if ! git fetch --all && ! git reset --hard origin/main; then
  echo "Error: Failed to update plugin code."
  exit 1
fi

if ! ./install; then
  echo "Error: Failed to install plugin"
fi

cd ~
