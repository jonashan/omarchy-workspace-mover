#!/bin/bash

BIN_PATH="$HOME/.local/bin"
PLUGIN_NAME="omarchy-workspace-mover"
PLUGIN_DIR="$HOME/.config/omarchy/plugins/$PLUGIN_NAME"
HYPRLAND_PLUGIN_FILE="$HOME/.config/hypr/plugins.conf"

# Remove binaries
if [ -d "$PLUGIN_DIR/$PLUGIN_NAME/bin" ]; then
  for file in "$PLUGIN_DIR/$PLUGIN_NAME/bin"/*; do
    if [ -f "$file" ]; then
      binary_name=$(basename "$file")
      if [ -f "$BIN_PATH/$binary_name" ]; then
        rm "$BIN_PATH/$binary_name"
      fi
    fi
  done
fi

# Remove hyprland config sources
if [ -f "$HYPRLAND_PLUGIN_FILE" ] && [ -d "$PLUGIN_DIR/hypr" ]; then
  for file in "$PLUGIN_DIR/hypr"/*; do
    if [ -f "$file" ]; then
      # Remove the source line from hyprland config
      sed -i "\|source = $file|d" "$HYPRLAND_PLUGIN_FILE"
    fi
  done
fi
